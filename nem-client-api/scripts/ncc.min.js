"use strict";define(["jquery","ractive","index"],function(t,e,n){var i=e.extend({el:document.body,template:"#template",faults:{101:"File not found",102:"Wallet has not been created",103:"Wallet file is corrupted",104:"Wrong password",105:"Wallet storage location has not been set",106:"Wallet is not opened",107:"Wallet does not contain this account",200:"Minimum fee is not met",201:"Due hours for a transaction must less than one day",202:"No public key",300:"HTTP client has not been started",301:"HTTP I/O exception",302:"HTTP status 400",303:"HTTP status unknown",304:"URL malformed",305:"NEM Infrastructure Server is not available",306:"Fault unexpected error"},settings:{fractionalDigits:2,decimalMark:"."},getPageParam:function(){for(var t,e,n,i=location.search.substring(1,location.search.length),s=i.split("&"),o=[],r=0;r<s.length;r++)t=s[r].split("="),t[0]&&t[1]&&(e=decodeURIComponent(t[0]),n=decodeURIComponent(t[1]),o[e]=n);return function(t){return o[t]}}(),ajaxError:function(t,e,n){this.showError(e,n)},apiPath:function(t){return"../api/"+t},checkSuccess:function(t,e){return t.fault?(e||this.showError(t.fault["fault-id"]),!1):t.error?(e||this.showError(t.status,t.error),!1):!0},getRequest:function(e,n,i,s){var o=this,r={dataType:"json",type:"get",error:s?[]:t.proxy(this.ajaxError,o),success:function(t){o.checkSuccess(t,s)&&n&&n(t)}};t.extend(r,i),t.ajax(this.apiPath(e),r)},postRequest:function(e,n,i,s,o){var r=this,a={contentType:"application/json",dataType:"json",type:"post",data:JSON.stringify(n),error:o?[]:t.proxy(this.ajaxError,r),success:function(t){r.checkSuccess(t,o)&&i&&i(t)}};t.extend(a,s),t.ajax(this.apiPath(e),a)},syncRequest:function(e){return t.ajax(e,{async:!1,type:"GET",error:this.ajaxError}).responseText},formatAddress:function(t){return"string"==typeof t?t.match(/.{1,6}/g).join("-"):t},addThousandSeparators:function(t){return t.toString(10).replace(/\B(?=(\d{3})+(?!\d))/g,"&thinsp;")},fixedDigits:function(t,e){for(t=t.toString(10);t.length<e;)t="0"+t;return t},formatCurrency:function(t,e){var n=this.addThousandSeparators(Math.floor(t)),i=this.fixedDigits(Math.round(t%1*1e6),this.settings.fractionalDigits);if(i=i.substring(0,this.settings.fractionalDigits),e){for(var s=i.length-1;"0"===i.charAt(s);)s--;s++;var o=i.substring(0,s),r=i.substring(s,i.length);if(r)return o?n+this.settings.decimalMark+o+'<span class="dimmed">'+r+"</span>":n+'<span class="dimmed">'+this.settings.decimalMark+r+"</span>"}return n+this.settings.decimalMark+i},formatDate:function(t,e){switch("number"==typeof t&&(t=new Date(t)),e){case"MM/dd/yy hh:mm:ss":var n=this.fixedDigits(t.getMonth(),2),i=this.fixedDigits(t.getDate(),2),s=this.fixedDigits(t.getYear(),2),o=this.fixedDigits(t.getHours(),2),r=this.fixedDigits(t.getMinutes(),2),a=this.fixedDigits(t.getSeconds(),2);return n+"/"+i+"/"+s+" "+o+":"+r+":"+a}},daysPassed:function(t){var e=(new Date).getTime(),n=e-t,i=864e5,s=n/i,o=Math.round(s);return{days:s,roundedDays:o}},recoverAddress:function(t){return t.replace(/\-/g,"")},showModal:function(t){this.get("activeModal")&&this.hideCurrentModal(),this.set("activeModal",t)},hideCurrentModal:function(){this.set("activeModal",null)},showError:function(t,e){this.set("errorModal",{}),e||"number"!=typeof t||(e=this.faults[t]),this.set("errorModal.errorId",t),this.set("errorModal.message",e||"Unknown error"),this.showModal("error")},showMessage:function(t){this.set("messageModal.message",t),this.showModal("message")},showConfirmation:function(t,e,n,i){this.set("confirmModal.message",t),this.set("confirmModal.options",e||["yes","no"]),this.set("confirmModal.labels",n||{yes:"Yes",no:"No"}),this.set("confirmModal.callbacks",i)},showTempMessage:function(t,e){e||(e=2e3),this.set("tempMessage.message",t),this.set("tempMessage.visible",!0);var n=this;window.setTimeout(function(){n.set("tempMessage.visible",!1)},e)},toggleOn:function(e){var n="active."+e;if(!this.get(n)){this.set(n,!0);var i=!0,s=this;t(document).on("click."+e,function(n){return i?(i=!1,void 0):(s.nodes[e]===n.target||t.contains(s.nodes[e],n.target)||s.toggleOff(e),void 0)})}},toggleOff:function(e){this.set("active."+e,!1),t(document).off("click."+e)},openWallet:function(t){var e=t.primaryAccount&&t.primaryAccount.address;if(e){t.daysPassed=this.daysPassed(t.lastRefresh),t.lastRefreshDate=new Date(t.lastRefresh).toString(),this.set("wallet",t);var n=this;this.postRequest("wallet/account/info",{wallet:t.name,account:e},function(t){n.set("activeAccount",t),n.loadPage("dashboard")})}else this.showError()},loadPage:n,init:function(){this.on({redirect:function(t,e){n(e)},toggleOn:function(t,e){this.toggleOn(e)},toggleOff:function(t,e){this.toggleOff(e)},closeModal:this.hideCurrentModal,modalContainerClick:function(t){t.node===t.original.target&&this.hideCurrentModal()},confirm:function(){var t=confirmModal.yes;t&&t()},shutdown:function(){this.getRequest("shutdown")}}),this.set("formatAddress",this.formatAddress),this.set("formatCurrency",this.formatCurrency),this.set("formatDate",this.formatDate)},reload:function(t,e){for(var n=!1,i=0;i<t.length;i++){var s="layout."+i;if(n||ncc.get(s)!==t[i]){var o=this;!function(){var n=i,r=s;require(e[n],function(e,i){o.set(r,null),o.partials[n]=e,o.set(r,t[n]),i&&i()})}(),n=!0}}}});return function(t){t.fn.expand=function(e){return this.each(function(){var n=t(this),i={},s={horizontally:!1,contentSelector:".content"},o=function(e){return t.extend({},s,n.data(),e)},r=function(){var t=n.find(i.contentSelector);if(t[0])if(i.horizontally){var e=t.outerWidth();n.animate({width:e},{complete:function(){n.width("auto")}})}else{var s=t.outerHeight();n.animate({height:s},{complete:function(){n.height("auto")}})}};i=o(e),r()})}}(window.jQuery),function(t){t.fn.collapse=function(e){return this.each(function(){var n=t(this),i={},s={horizontally:!1,contentSelector:".content"},o=function(e){return t.extend({},s,n.data(),e)},r=function(){var t=n.find(i.contentSelector);if(t[0])if(i.horizontally){var e=t.outerWidth();n.width(e),n.animate({width:0})}else{var s=t.outerHeight();n.height(s),n.animate({height:0})}};i=o(e),r()})}}(window.jQuery),window.ncc=new i,ncc});